Found 4 GPU(s)
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB

=== Test 1: GPU 0 -> GPU 0 (D2D) ===
size                          	time(ms)                      	bw(GB/s)                      
1                             0.104032                      0.000260                      
2                             0.099008                      0.000546                      
4                             0.102112                      0.001058                      
8                             0.100032                      0.002160                      
16                            0.101472                      0.004259                      
32                            0.100768                      0.008577                      
64                            0.098080                      0.017624                      
128                           0.100864                      0.034275                      
256                           0.100224                      0.068987                      
512                           0.101408                      0.136363                      
1024                          0.100704                      0.274632                      
2048                          0.100192                      0.552071                      
4096                          0.102336                      1.081010                      
8192                          0.100192                      2.208284                      
16384                         0.103264                      4.285181                      
32768                         0.101888                      8.686104                      
65536                         0.103744                      17.061416                     
131072                        0.110656                      31.991388                     
262144                        0.111904                      63.269212                     
524288                        0.120160                      117.844178                    
1048576                       0.150784                      187.820408                    
2097152                       0.170144                      332.898150                    
4194304                       0.228576                      495.595547                    
8388608                       0.329824                      686.919386                    
16777216                      0.686848                      659.716575                    
33554432                      1.616640                      560.576267                    
67108864                      3.096864                      585.269488                    
134217728                     6.038304                      600.334148                    
268435456                     11.923200                     608.058257                    
536870912                     23.797632                     609.304315                    
1073741824                    47.348927                     612.474286                    
2147483648                    94.418846                     614.284143                    
4294967296                    187.528152                    618.573790                    

=== Test 2: GPU 0 -> CPU (D2H) ===
size                          	time(ms)                      	bw(GB/s)                      
1                             0.172672                      0.000156                      
2                             0.173376                      0.000312                      
4                             0.172256                      0.000627                      
8                             0.173792                      0.001243                      
16                            0.176000                      0.002455                      
32                            0.176352                      0.004901                      
64                            0.175296                      0.009861                      
128                           0.178112                      0.019410                      
256                           0.176000                      0.039285                      
512                           0.176512                      0.078342                      
1024                          0.179680                      0.153921                      
2048                          0.178176                      0.310441                      
4096                          0.177728                      0.622447                      
8192                          0.183232                      1.207499                      
16384                         0.191328                      2.312808                      
32768                         0.209472                      4.224955                      
65536                         0.245056                      7.222918                      
131072                        0.317632                      11.145096                     
262144                        0.463392                      15.278810                     
524288                        0.751776                      18.835606                     
1048576                       1.328320                      21.320399                     
2097152                       2.481248                      22.827475                     
4194304                       4.805088                      23.575270                     
8388608                       9.419936                      24.051384                     
16777216                      18.659840                     24.283435                     
33554432                      37.121471                     24.413095                     
67108864                      74.051651                     24.476159                     
134217728                     147.928543                    24.505075                     
268435456                     295.663605                    24.521111                     
536870912                     591.077942                    24.531452                     
1073741824                    1181.913086                   24.536491                     
2147483648                    2363.701416                   24.537786                     
4294967296                    4726.972168                   24.540022                     

GPU 0 can access GPU 1 peer memory
GPU Direct enabled for Test 3

=== Test 3: GPU 0 -> GPU 1 with GPU Direct (P2P) ===
size                          	time(ms)                      	bw(GB/s)                      
1                             0.326752                      0.000083                      
2                             0.206944                      0.000261                      
4                             0.205376                      0.000526                      
8                             0.212736                      0.001016                      
16                            0.213536                      0.002024                      
32                            0.205408                      0.004208                      
64                            0.213472                      0.008097                      
128                           0.204192                      0.016930                      
256                           0.213536                      0.032379                      
512                           0.213472                      0.064778                      
1024                          0.211584                      0.130712                      
2048                          0.221600                      0.249608                      
4096                          0.210432                      0.525710                      
8192                          0.231968                      0.953806                      
16384                         0.231552                      1.911039                      
32768                         0.231424                      3.824192                      
65536                         0.239744                      7.382957                      
131072                        0.267872                      13.215413                     
262144                        0.299552                      23.635557                     
524288                        0.359296                      39.410838                     
1048576                       0.529408                      53.494306                     
2097152                       0.834880                      67.842834                     
4194304                       1.526304                      74.219323                     
8388608                       2.827968                      80.114948                     
16777216                      5.417728                      83.637459                     
33554432                      10.600864                     85.488312                     
67108864                      20.962208                     86.465129                     
134217728                     41.661247                     87.011317                     
268435456                     83.028191                     87.319740                     
536870912                     165.800858                    87.454312                     
1073741824                    331.319092                    87.528913                     
2147483648                    662.357300                    87.566031                     
4294967296                    1324.411499                   87.586071                     

GPU Direct disabled for Test 4

=== Test 4: GPU 0 -> CPU -> GPU 1 (Staged, no GPU Direct, Sync) ===
size                          	time(ms)                      	bw(GB/s)                      
1                             0.459968                      0.000059                      
2                             0.445376                      0.000121                      
4                             0.445632                      0.000242                      
8                             0.448576                      0.000482                      
16                            0.447840                      0.000965                      
32                            0.445760                      0.001939                      
64                            0.445952                      0.003876                      
128                           0.459744                      0.007520                      
256                           0.459456                      0.015049                      
512                           0.447488                      0.030902                      
1024                          0.450304                      0.061418                      
2048                          0.454112                      0.121805                      
4096                          0.461088                      0.239924                      
8192                          0.490048                      0.451491                      
16384                         0.536736                      0.824437                      
32768                         0.515104                      1.718119                      
65536                         0.578912                      3.057493                      
131072                        0.725184                      4.881573                      
262144                        1.008960                      7.017204                      
524288                        1.584416                      8.937145                      
1048576                       2.738688                      10.340832                     
2097152                       5.030496                      11.259451                     
4194304                       9.610176                      11.787635                     
8388608                       18.788193                     12.058770                     
16777216                      37.128574                     12.204212                     
33554432                      73.782532                     12.282718                     
67108864                      147.085693                    12.322748                     
134217728                     293.516632                    12.350237                     
268435456                     586.592102                    12.359525                     
536870912                     1172.796997                   12.363606                     
1073741824                    2345.000244                   12.366736                     
2147483648                    4689.512207                   12.368024                     
4294967296                    9378.343750                   12.368922                     

=== Test 5: GPU 0 -> CPU -> GPU 1 (Staged, Async with Pipelining) (Async, 4 chunks) ===
size                          	time(ms)                      	bw(GB/s)                      
4096                          0.858624                      0.128841                      
8192                          0.925824                      0.238979                      
16384                         0.917760                      0.482158                      
32768                         1.038464                      0.852230                      
65536                         1.063488                      1.664353                      
131072                        1.101504                      3.213823                      
262144                        1.226016                      5.774866                      
524288                        1.572544                      9.004617                      
1048576                       2.388576                      11.856567                     
2097152                       4.021536                      14.084327                     
4194304                       7.356384                      15.399040                     
8388608                       13.712544                     16.522280                     
16777216                      26.866880                     16.865561                     
33554432                      53.008705                     17.096249                     
67108864                      105.090019                    17.247118                     
134217728                     209.686462                    17.287716                     
268435456                     419.230377                    17.293594                     
536870912                     837.445496                    17.314560                     
1073741824                    1674.742310                   17.316097                     
2147483648                    3348.859131                   17.319331                     
4294967296                    6697.516602                   17.319853                     

All tests completed!
