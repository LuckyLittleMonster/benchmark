Found 4 GPU(s)
GPU 0: NVIDIA A100-SXM4-80GB
GPU 1: NVIDIA A100-SXM4-80GB

=== Test 1: GPU 0 -> GPU 0 (D2D) ===
size                          	time(us)                      	bw(MB/s)                      
1                             3.080828                      0.309551                      
2                             3.044414                      0.626508                      
4                             2.942897                      1.296239                      
8                             3.017931                      2.528021                      
16                            2.998069                      5.089539                      
32                            2.995862                      10.186577                     
64                            2.982621                      20.463599                     
128                           2.956138                      41.293850                     
256                           3.030069                      80.572631                     
512                           2.982621                      163.708793                    
1024                          3.021241                      323.232213                    
2048                          2.985931                      654.109185                    
4096                          2.958345                      1320.417442                   
8192                          3.002483                      2602.013279                   
16384                         2.996965                      5213.606945                   
32768                         3.099586                      10081.991034                  
65536                         3.116138                      20056.877952                  
131072                        3.264000                      38296.569416                  
262144                        3.310345                      75520.832677                  
524288                        3.563034                      140329.827510                 
1048576                       4.390620                      227758.242316                 
2097152                       4.961103                      403136.141097                 
4194304                       6.788414                      589239.289733                 
8388608                       9.833931                      813509.885845                 
16777216                      19.790345                     808475.032559                 
33554432                      46.170481                     693083.526207                 
67108864                      88.482207                     723309.261579                 
134217728                     172.325512                    742780.324131                 
268435456                     338.799444                    755609.268939                 
536870912                     677.103437                    756162.163491                 
1073741824                    1345.562507                   761020.015342                 
2147483648                    2671.103905                   766724.198252                 
4294967296                    5318.758734                   770104.493282                 

=== Test 2: GPU 0 -> CPU (D2H) ===
size                          	time(us)                      	bw(MB/s)                      
1                             6.215724                      0.153429                      
2                             6.151724                      0.310051                      
4                             6.118621                      0.623457                      
8                             6.245517                      1.221579                      
16                            6.339311                      2.407011                      
32                            6.259862                      4.875120                      
64                            6.138483                      9.943036                      
128                           6.254345                      19.517682                     
256                           6.183724                      39.481165                     
512                           6.796138                      71.846871                     
1024                          6.114207                      159.720223                    
2048                          6.116414                      319.325187                    
4096                          6.167172                      633.394005                    
8192                          6.356965                      1228.966897                   
16384                         6.642759                      2352.185344                   
32768                         7.237517                      4317.779082                   
65536                         8.464552                      7383.734222                   
131072                        10.964966                     11399.944123                  
262144                        16.051862                     15574.517395                  
524288                        26.153930                     19117.585549                  
1048576                       45.984001                     21746.694032                  
2097152                       85.680551                     23342.520413                  
4194304                       165.747856                    24133.042140                  
8388608                       324.722750                    24636.401328                  
16777216                      644.952248                    24808.038196                  
33554432                      1280.340918                   24993.343215                  
67108864                      2553.586763                   25062.786563                  
134217728                     5099.922969                   25098.418303                  
268435456                     10196.369040                  25106.976710                  
536870912                     20380.878317                  25121.586618                  
1073741824                    40755.333210                  25125.546017                  
2147483648                    81502.820245                  25127.964822                  
4294967296                    163002.677128                 25128.421644                  

GPU 0 can access GPU 1 peer memory
GPU Direct enabled for Test 3

=== Test 3: GPU 0 -> GPU 1 with GPU Direct (P2P) ===
size                          	time(us)                      	bw(MB/s)                      
1                             11.258483                     0.084707                      
2                             6.870069                      0.277632                      
4                             6.955034                      0.548480                      
8                             7.102896                      1.074124                      
16                            6.868966                      2.221410                      
32                            6.850207                      4.454986                      
64                            7.191172                      8.487511                      
128                           7.174621                      17.014183                     
256                           6.918620                      35.287472                     
512                           6.806069                      71.742038                     
1024                          7.110621                      137.338569                    
2048                          7.440552                      262.497340                    
4096                          7.037793                      555.039038                    
8192                          7.150345                      1092.604652                   
16384                         7.479172                      2089.134909                   
32768                         7.640276                      4090.166389                   
65536                         8.104827                      7711.453563                   
131072                        9.124414                      13699.510439                  
262144                        10.522483                     23758.651504                  
524288                        12.460138                     40127.965632                  
1048576                       18.520275                     53994.878391                  
2097152                       29.647449                     67459.429721                  
4194304                       51.470345                     77714.652271                  
8388608                       97.456554                     82087.860497                  
16777216                      186.784004                    85660.440016                  
33554432                      365.408009                    87573.340399                  
67108864                      722.038072                    88637.985316                  
134217728                     1436.345331                   89115.059779                  
268435456                     2863.315977                   89406.828330                  
536870912                     5718.251195                   89537.864375                  
1073741824                    11426.674678                  89614.872990                  
2147483648                    22842.472471                  89657.544847                  
4294967296                    45675.280341                  89676.515819                  

GPU Direct disabled for Test 4

=== Test 4: GPU 0 -> CPU -> GPU 1 (Staged, no GPU Direct, Sync) ===
size                          	time(us)                      	bw(MB/s)                      
1                             15.064275                     0.063307                      
2                             15.261793                     0.124975                      
4                             14.990345                     0.254477                      
8                             15.046621                     0.507050                      
16                            15.025655                     1.015516                      
32                            15.052138                     2.027458                      
64                            15.049931                     4.055511                      
128                           14.957241                     8.161285                      
256                           15.126069                     16.140388                     
512                           15.397517                     31.711688                     
1024                          15.175724                     64.350308                     
2048                          15.394207                     126.874027                    
4096                          15.768276                     247.728410                    
8192                          16.360828                     477.512520                    
16384                         18.019310                     867.125305                    
32768                         17.302069                     1806.142357                   
65536                         19.860966                     3146.876067                   
131072                        24.794482                     5041.444312                   
262144                        34.447448                     7257.431667                   
524288                        54.679172                     9144.249695                   
1048576                       94.253244                     10609.714391                  
2097152                       173.282212                    11541.865575                  
4194304                       331.025650                    12083.655762                  
8388608                       647.208839                    12360.770624                  
16777216                      1279.065362                   12509.133990                  
33554432                      2542.298416                   12587.035339                  
67108864                      5070.349332                   12622.404457                  
134217728                     10120.477084                  12647.625100                  
268435456                     20224.131617                  12658.145469                  
536870912                     40432.440396                  12663.099110                  
1073741824                    80849.306304                  12665.538479                  
2147483648                    161675.444504                 12667.353452                  
4294967296                    323336.072198                 12667.933931                  

=== Test 5: GPU 0 -> CPU -> GPU 1 (Staged, Async with Pipelining) (Async, 4 chunks) ===
size                          	time(us)                      	bw(MB/s)                      
4096                          29.934345                     130.493921                    
8192                          30.447448                     256.589648                    
16384                         30.606344                     510.515078                    
32768                         33.261242                     939.531975                    
65536                         33.780965                     1850.154352                   
131072                        39.151447                     3192.730051                   
262144                        43.399724                     5760.405235                   
524288                        54.622897                     9153.670519                   
1048576                       81.690484                     12241.327876                  
2097152                       139.764967                    14309.737613                  
4194304                       254.539029                    15714.682382                  
8388608                       474.494901                    16860.033648                  
16777216                      930.601909                    17193.173409                  
33554432                      1840.477779                   17386.789651                  
67108864                      3635.030023                   17606.457057                  
134217728                     7247.362334                   17661.597985                  
268435456                     14451.990588                  17713.822774                  
536870912                     28867.698933                  17736.086316                  
1073741824                    57752.879176                  17730.717752                  
2147483648                    115445.666083                 17739.947020                  
4294967296                    230780.492322                 17748.467207                  

All tests completed!
