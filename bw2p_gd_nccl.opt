Parent process using GPU 0: NVIDIA A100-SXM4-40GB
Child process using GPU 1: NVIDIA A100-SXM4-40GB
Child: NCCL comm initialized, waiting for parent to finish...

=== P2P Bandwidth Test (GPU 0 -> GPU 1 via NCCL) ===
size                          	time(ms)                      	bw(GB/s)                      
1                             0.066560                      0.000406                      
2                             0.064512                      0.000837                      
4                             0.138240                      0.000781                      
8                             0.143360                      0.001507                      
16                            0.137216                      0.003149                      
32                            0.139264                      0.006206                      
64                            0.137216                      0.012597                      
128                           0.137216                      0.025194                      
256                           0.137216                      0.050389                      
512                           0.140288                      0.098571                      
1024                          0.144384                      0.191549                      
2048                          0.144384                      0.383097                      
4096                          0.139264                      0.794363                      
8192                          0.166912                      1.325563                      
16384                         0.174080                      2.541963                      
32768                         0.172032                      5.144449                      
65536                         0.178176                      9.934107                      
131072                        0.193536                      18.291373                     
262144                        0.233472                      30.325170                     
524288                        0.318464                      44.463914                     
1048576                       0.493568                      57.378745                     
2097152                       0.839680                      67.455011                     
4194304                       1.576960                      71.835210                     
8388608                       2.942976                      76.984148                     
16777216                      5.682176                      79.744976                     
33554432                      11.199488                     80.918880                     
67108864                      22.711296                     79.806101                     
134217728                     44.262402                     81.897951                     
268435456                     88.123390                     82.271006                     
536870912                     175.979523                    82.395950                     
1073741824                    352.619507                    82.241621                     
2147483648                    705.924072                    82.161811                     
4294967296                    1413.319702                   82.076263                     

Parent: Testing complete, starting cleanup...
Child: Parent finished, starting cleanup...
Parent: Cleanup complete
Child: Cleanup complete

Both processes completed successfully!
