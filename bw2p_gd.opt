Parent process using GPU 0: NVIDIA A100-SXM4-40GB
Parent: Waiting for child to create IPC handle...
Child process using GPU 1: NVIDIA A100-SXM4-40GB
Child: IPC handle created, waiting for parent to finish...

=== P2P Bandwidth Test (GPU 0 -> GPU 1 via fork+IPC) ===
size                          	time(ms)                      	bw(GB/s)                      
1                             0.079872                      0.000338                      
2                             0.079872                      0.000676                      
4                             0.154624                      0.000699                      
8                             0.153600                      0.001407                      
16                            0.152576                      0.002832                      
32                            0.154624                      0.005589                      
64                            0.153600                      0.011253                      
128                           0.154624                      0.022358                      
256                           0.153600                      0.045014                      
512                           0.154624                      0.089432                      
1024                          0.157696                      0.175379                      
2048                          0.153600                      0.360111                      
4096                          0.156672                      0.706101                      
8192                          0.186368                      1.187180                      
16384                         0.194560                      2.274388                      
32768                         0.195584                      4.524960                      
65536                         0.194560                      9.097551                      
131072                        0.214016                      16.541001                     
262144                        0.252928                      27.992466                     
524288                        0.343040                      41.278442                     
1048576                       0.507904                      55.759185                     
2097152                       0.861184                      65.770642                     
4194304                       1.611776                      70.283495                     
8388608                       2.959360                      76.557941                     
16777216                      5.694464                      79.572895                     
33554432                      11.216896                     80.793296                     
67108864                      22.810623                     79.458592                     
134217728                     44.291073                     81.844935                     
268435456                     88.022018                     82.365755                     
536870912                     176.214020                    82.286302                     
1073741824                    352.843781                    82.189347                     
2147483648                    706.390015                    82.107616                     
4294967296                    1413.338135                   82.075193                     
Child: Parent finished, cleaning up...

Both processes completed successfully!
