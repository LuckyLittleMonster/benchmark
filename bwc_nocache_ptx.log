Found 4 GPU(s)

GPU 0: NVIDIA A100-SXM4-80GB
  Clock rate: 1.41 GHz
  L2 Cache: 40 MB

GPU 1: NVIDIA A100-SXM4-80GB
  Clock rate: 1.41 GHz

P2P Access (GPU 0 -> GPU 1): Supported

Using PTX cache bypass instructions:
  ld.global.cv.f32 - load with cache volatile (bypasses cache on read)
  st.global.wb.f32 - store with write-back (bypasses cache on write)

P2P Test Types:
  PUT: GPU 0 kernel reads local memory, writes to GPU 1 (local read + remote write)
  GET: GPU 0 kernel reads GPU 1 memory, writes local (remote read + local write)

P2P enabled: GPU 0 -> GPU 1


=== Test 1: GPU 0 -> GPU 0 (D2D internal, baseline) ===
size(B)        	latency(us)    	bw(MB/s)       
4              	0.303969       	12.549636      
8              	0.303942       	25.101460      
16             	0.304159       	50.167093      
32             	0.304065       	100.365389     
64             	0.304934       	200.158754     
128            	0.292396       	417.482407     
256            	0.292585       	834.425098     
512            	0.291416       	1675.545485    
1024           	0.295861       	3300.750605    
2048           	0.296588       	6585.316643    
4096           	0.306298       	12753.114468   
8192           	0.596191       	13104.022299   
16384          	1.055169       	14808.058537   
32768          	2.131951       	14657.937359   
65536          	4.285641       	14583.583375   

=== Test 2: CPU Memory -> GPU 0 (UMA read, run on GPU 0) ===
size(B)        	latency(us)    	bw(MB/s)       
4              	0.772693       	4.936887       
8              	0.772846       	9.871815       
16             	0.772778       	19.745368      
32             	0.772896       	39.484697      
64             	0.775381       	78.716294      
128            	0.785141       	155.475702     
256            	0.785150       	310.947716     
512            	0.785325       	621.757011     
1024           	0.788781       	1238.065893    
2048           	0.791884       	2466.427886    
4096           	0.801634       	4872.859251    
8192           	1.743348       	4481.318881    
16384          	3.474946       	4496.472863    
32768          	6.842019       	4567.364952    
65536          	13.640667      	4581.887397    

=== Test 3: GPU 0 -> CPU Memory (UMA write, run on GPU 0) ===
size(B)        	latency(us)    	bw(MB/s)       
4              	0.304283       	12.536665      
8              	0.300024       	25.429250      
16             	0.301994       	50.526726      
32             	0.304132       	100.343167     
64             	0.305024       	200.099522     
128            	0.292664       	417.101232     
256            	0.289214       	844.151797     
512            	0.290504       	1680.809533    
1024           	0.298370       	3272.989097    
2048           	0.300618       	6497.043094    
4096           	0.350643       	11140.238128   
8192           	0.684507       	11413.327588   
16384          	1.080584       	14459.775575   
32768          	2.214597       	14110.919286   
65536          	4.419354       	14142.339020   

=== Test 4: PUT - GPU 0 -> GPU 1 (run on GPU 0, local read + remote write) ===
size(B)        	latency(us)    	bw(MB/s)       
4              	0.304278       	12.536872      
8              	0.304171       	25.082601      
16             	0.300025       	50.858380      
32             	0.302818       	100.778529     
64             	0.304992       	200.120672     
128            	0.292664       	417.101232     
256            	0.289081       	844.540895     
512            	0.294185       	1659.775521    
1024           	0.298637       	3270.068376    
2048           	0.301129       	6486.007212    
4096           	0.351408       	11115.983241   
8192           	0.690097       	11320.877011   
16384          	1.094055       	14281.725873   
32768          	2.210145       	14139.345657   
65536          	4.422631       	14131.860923   

=== Test 5: GET - GPU 1 -> GPU 0 (run on GPU 0, remote read + local write) ===
size(B)        	latency(us)    	bw(MB/s)       
4              	0.577419       	6.606465       
8              	0.571083       	13.359516      
16             	0.571042       	26.720942      
32             	0.571042       	53.441884      
64             	0.574285       	106.280180     
128            	0.569425       	214.374795     
256            	0.569846       	428.432655     
512            	0.592315       	824.360281     
1024           	0.590782       	1652.998939    
2048           	0.581655       	3357.876260    
4096           	0.585744       	6668.869399    
8192           	1.146488       	6814.291057    
16384          	2.412451       	6476.816163    
32768          	4.665334       	6698.341149    
65536          	9.241962       	6762.633174    

All tests completed!

Note: Using PTX .cv (load) + .wb (store) for complete cache bypass.
This measures true memory access latency without cache.
