./run_mpi_bwl.sh

════════════════════════════════════════════════════════
  MPI GPU Direct RDMA Performance Test
════════════════════════════════════════════════════════

Communication: MPI Send/Recv (GPU-aware)
Test Suite:
  1. Unidirectional Bandwidth (Rank 0 -> Rank 1)
  2. Ping-Pong with 1-byte Ack
  3. Ping-Pong with Same-size Reply

Compiling mpi_bwl.c...
✓ Compilation successful

════════════════════════════════════════════════════════
  Environment Configuration
════════════════════════════════════════════════════════
GPU Support:     Enabled (Cray MPICH)
GPU Direct RDMA: Enabled

════════════════════════════════════════════════════════
  Starting Test (2 nodes, 1 task per node)
════════════════════════════════════════════════════════

srun: job 44605431 queued and waiting for resources
srun: job 44605431 has been allocated resources
=== MPI GPU Direct RDMA Performance Tests ===
Using GPU-aware MPI (Cray MPICH)
Max message size: 10 MB

=== Test 1: Unidirectional (Rank 0 -> Rank 1) ===
size                          latency(us)                   BW(MB/s)                      
1                             2.412276                      0.000470                      
2                             2.377345                      0.000954                      
4                             2.470276                      0.001836                      
8                             2.421241                      0.003747                      
16                            2.378414                      0.007628                      
32                            2.397069                      0.015138                      
64                            3.632552                      0.019979                      
128                           6.452828                      0.022494                      
256                           6.990069                      0.041530                      
512                           7.215000                      0.080471                      
1024                          7.167655                      0.162004                      
2048                          7.259552                      0.319907                      
4096                          7.257138                      0.640028                      
8192                          7.689690                      1.208051                      
16384                         8.484690                      2.189717                      
32768                         15.994069                     2.323245                      
65536                         17.853172                     4.162638                      
131072                        20.850690                     7.128425                      
262144                        27.142172                     10.952151                     
524288                        40.397828                     14.716888                     
1048576                       63.279690                     18.790557                     
2097152                       111.793241                    21.272496                     
4194304                       205.469345                    23.148186                     
8388608                       395.020655                    24.080982                     

=== Test 2: Ping-Pong with 1-byte Ack ===
size                          latency(us)                   BW(MB/s)                      
1                             8.919655                      0.000254                      
2                             9.295552                      0.000366                      
4                             9.495931                      0.000597                      
8                             9.328069                      0.001094                      
16                            8.946621                      0.002155                      
32                            9.634172                      0.003884                      
64                            10.857586                     0.006789                      
128                           14.251724                     0.010264                      
256                           9.319034                      0.031273                      
512                           9.486310                      0.061323                      
1024                          9.548483                      0.121729                      
2048                          9.824862                      0.236494                      
4096                          10.024552                     0.463452                      
8192                          9.960655                      0.932737                      
16384                         10.790517                     1.721901                      
32768                         18.106793                     2.052229                      
65536                         19.983862                     3.718872                      
131072                        22.954448                     6.475160                      
262144                        30.280690                     9.817025                      
524288                        42.703000                     13.922475                     
1048576                       65.309483                     18.206572                     
2097152                       113.146207                    21.018136                     
4194304                       217.737241                    21.843961                     
8388608                       403.980379                    23.546902                     

=== Test 3: Ping-Pong with Same-size Reply ===
size                          latency(us)                   BW(MB/s)                      
1                             4.381931                      0.000259                      
2                             5.039586                      0.000450                      
4                             5.047517                      0.000899                      
8                             5.066707                      0.001790                      
16                            4.565569                      0.003974                      
32                            5.252052                      0.006909                      
64                            6.569793                      0.011047                      
128                           9.921259                      0.014630                      
256                           4.957017                      0.058563                      
512                           5.068431                      0.114551                      
1024                          5.076379                      0.228744                      
2048                          5.270897                      0.440605                      
4096                          5.327207                      0.871896                      
8192                          5.651983                      1.643589                      
16384                         7.874379                      2.359433                      
32768                         13.895862                     2.674044                      
65536                         15.722672                     4.726696                      
131072                        18.307500                     8.118672                      
262144                        24.629034                     12.069704                     
524288                        37.722138                     15.760780                     
1048576                       62.815707                     18.929352                     
2097152                       107.946828                    22.030488                     
4194304                       205.945621                    23.094653                     
8388608                       400.341966                    23.760899                     

=== All Tests Complete ===

════════════════════════════════════════════════════════
  Test Complete
════════════════════════════════════════════════════════

✓ Test completed successfully

Performance Notes:
  - MPI uses libfabric (CXI provider) internally
  - GPU Direct RDMA enabled automatically
  - Compare with bwl.c (direct libfabric) and nccl_bwl.c (NCCL)